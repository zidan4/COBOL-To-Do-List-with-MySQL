IDENTIFICATION DIVISION.
PROGRAM-ID. TODO-LIST.

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
SPECIAL-NAMES.
    DECIMAL-POINT IS COMMA.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-TASK-ID     PIC 9(4).
01 WS-TASK-NAME   PIC X(50).
01 WS-USER-INPUT  PIC X(1).
EXEC SQL INCLUDE SQLCA END-EXEC.

PROCEDURE DIVISION.
MAIN-PROCESS.
    DISPLAY "1. Add Task".
    DISPLAY "2. View Tasks".
    DISPLAY "3. Exit".
    DISPLAY "Select an option: ".
    ACCEPT WS-USER-INPUT.

    EVALUATE WS-USER-INPUT
        WHEN "1" PERFORM ADD-TASK
        WHEN "2" PERFORM VIEW-TASKS
        WHEN "3" STOP RUN
        WHEN OTHER DISPLAY "Invalid option! Try again."
    END-EVALUATE.

ADD-TASK.
    DISPLAY "Enter task name: ".
    ACCEPT WS-TASK-NAME.

    EXEC SQL
        INSERT INTO tasks (task_name) VALUES (:WS-TASK-NAME)
    END-EXEC.

    IF SQLCODE = 0
        DISPLAY "Task added successfully!"
    ELSE
        DISPLAY "Error adding task!" SQLERRMC.

    PERFORM MAIN-PROCESS.

VIEW-TASKS.
    EXEC SQL
        DECLARE TASK_CURSOR CURSOR FOR
        SELECT id, task_name FROM tasks
    END-EXEC.

    EXEC SQL OPEN TASK_CURSOR END-EXEC.

    PERFORM UNTIL SQLCODE NOT = 0
        EXEC SQL FETCH TASK_CURSOR INTO :WS-TASK-ID, :WS-TASK-NAME END-EXEC
        IF SQLCODE = 0
            DISPLAY WS-TASK-ID " - " WS-TASK-NAME
    END-PERFORM.

    EXEC SQL CLOSE TASK_CURSOR END-EXEC.

    PERFORM MAIN-PROCESS.
